{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [
    "cc",
    "Class",
    "extends",
    "Component",
    "properties",
    "phone",
    "default",
    "type",
    "Node",
    "code",
    "codeBtn",
    "submit",
    "mask",
    "spirteFrames",
    "SpriteFrame",
    "close",
    "codeBtnText",
    "Label",
    "onLoad",
    "init",
    "listen",
    "state",
    "wait",
    "time",
    "phoneInput",
    "getComponent",
    "EditBox",
    "codeInput",
    "window",
    "_main",
    "shop",
    "node",
    "zIndex",
    "countDown",
    "string",
    "toString",
    "codeReset",
    "setTimeout",
    "Sprite",
    "spriteFrame",
    "on",
    "EventType",
    "TOUCH_START",
    "event",
    "stopPropagation",
    "replace",
    "scale",
    "TOUCH_END",
    "api",
    "getCaptcha",
    "then",
    "res",
    "data",
    "ok",
    "alert",
    "m",
    "bindPhone",
    "user",
    "hide",
    "show",
    "active",
    "opacity",
    "runAction",
    "fadeIn",
    "sequence",
    "fadeOut",
    "callFunc"
  ],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "export default cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        phone: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        code: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        codeBtn: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        submit: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        mask: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        spirteFrames: {\r\n            default: [],\r\n            type: cc.SpriteFrame\r\n        },\r\n\r\n        close: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        codeBtnText: {\r\n            default: null,\r\n            type: cc.Label\r\n        }\r\n    },\r\n\r\n    onLoad: function () {\r\n        this.init()\r\n        this.listen()\r\n    },\r\n\r\n    init() {\r\n        // 网络请求状态\r\n        this.state = {\r\n            wait: false,\r\n            time: 0\r\n        }\r\n\r\n        this.phoneInput = this.phone.getComponent(cc.EditBox)\r\n        this.codeInput = this.code.getComponent(cc.EditBox)\r\n        window._main.shop.node.zIndex = 1\r\n    },\r\n\r\n    countDown() {\r\n        this.state.time--\r\n        this.codeBtnText.string = this.state.time.toString() + 's'\r\n        if (this.state.time === 0) {\r\n            this.codeReset()\r\n            return\r\n        }\r\n        setTimeout(() => {\r\n            this.countDown()\r\n        }, 1000)\r\n    },\r\n\r\n    codeReset() {\r\n        this.codeBtn.getComponent(cc.Sprite).spriteFrame =\r\n            this.spirteFrames[0]\r\n        this.codeBtnText.string = '获取验证码'\r\n    },\r\n\r\n    listen() {\r\n        this.mask.on(\r\n            cc.Node.EventType.TOUCH_START,\r\n            event => {\r\n                event.stopPropagation()\r\n            }\r\n        )\r\n\r\n        /*\r\n        * 手机号输入事件监听\r\n        * 替换非数字字符为空\r\n        */\r\n\r\n        this.phone.on('text-changed',\r\n            () => {\r\n                this.phoneInput.string = this.phoneInput.string.replace(/\\D/g, '')\r\n            }\r\n        )\r\n\r\n        /*\r\n        * 验证码输入事件监听\r\n        * 替换非数字字符为空\r\n        */\r\n\r\n        this.code.on('text-changed',\r\n            () => {\r\n                this.codeInput.string = this.codeInput.string.replace(/\\D/g, '')\r\n            }\r\n        )\r\n\r\n        /*\r\n        * 验证码按钮监听\r\n        */\r\n        this.codeBtn.on(\r\n            cc.Node.EventType.TOUCH_START,\r\n            () => {\r\n                this.codeBtn.scale = .95\r\n            }\r\n        )\r\n\r\n        this.codeBtn.on(\r\n            cc.Node.EventType.TOUCH_END,\r\n            () => {\r\n                this.codeBtn.scale = 1\r\n                if (this.state.wait) return\r\n                if (this.state.time) return\r\n\r\n                this.state.wait = true\r\n\r\n                window._main.api.getCaptcha(this.phoneInput.string)\r\n                .then(res => {\r\n                    if (res.data.ok) {\r\n                        // 启动倒计时\r\n                        this.state.time = 60\r\n                        this.countDown()\r\n\r\n                        this.codeBtn.getComponent(cc.Sprite).spriteFrame =\r\n                            this.spirteFrames[1]\r\n                    } else {\r\n                        alert(res.data.m)\r\n                    }\r\n                    this.state.wait = false\r\n                })\r\n\r\n            }\r\n        )\r\n\r\n\r\n        /*\r\n        * 提交按钮\r\n        */\r\n        this.submit.on(\r\n            cc.Node.EventType.TOUCH_START,\r\n            () => {\r\n                this.submit.scale = .95\r\n            }\r\n        )\r\n\r\n        this.submit.on(\r\n            cc.Node.EventType.TOUCH_END,\r\n            () => {\r\n                this.submit.scale = 1\r\n\r\n                window._main.api.bindPhone(\r\n                    this.phoneInput.string,\r\n                    this.codeInput.string\r\n                ).then(res => {\r\n                    if (res.data.ok) {\r\n                        window._main.user.phone = this.phoneInput.string\r\n                        this.hide()\r\n                        this.codeInput.string = ''\r\n                        this.phoneInput.string = ''\r\n                    } else {\r\n                        alert(res.data.m)\r\n                    }\r\n                })\r\n            }\r\n        )\r\n\r\n        /*\r\n        * 关闭按钮\r\n        */\r\n        this.close.on(\r\n            cc.Node.EventType.TOUCH_START,\r\n            () => {\r\n                this.close.scale = .95\r\n            }\r\n        )\r\n\r\n        this.close.on(\r\n            cc.Node.EventType.TOUCH_END,\r\n            () => {\r\n                this.close.scale = 1\r\n                this.hide()\r\n            }\r\n        )\r\n\r\n    },\r\n\r\n    show() {\r\n        if (this.node.active) this.node.opacity = 0\r\n        else {\r\n            this.node.active = true\r\n            this.node.opacity = 0\r\n        }\r\n        this.node.runAction(cc.fadeIn(.5))\r\n    },\r\n\r\n    hide() {\r\n        this.node.runAction(cc.sequence(\r\n            cc.fadeOut(.5),\r\n            cc.callFunc(() => {\r\n                this.node.active = false\r\n            })\r\n        ))\r\n    }\r\n})\r\n"
  ]
}