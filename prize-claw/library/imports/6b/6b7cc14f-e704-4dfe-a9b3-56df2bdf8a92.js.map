{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [
    "cc",
    "Class",
    "extends",
    "Component",
    "properties",
    "close",
    "default",
    "type",
    "Node",
    "mask",
    "layout",
    "item",
    "Prefab",
    "other",
    "loginBtn",
    "prizeDetail",
    "onLoad",
    "init",
    "listen",
    "on",
    "EventType",
    "TOUCH_START",
    "event",
    "stopPropagation",
    "scale",
    "TOUCH_END",
    "hide",
    "window",
    "_main",
    "login",
    "show",
    "_this",
    "api",
    "monitor",
    "node",
    "active",
    "opacity",
    "runAction",
    "fadeIn",
    "user",
    "phone",
    "grabHistory",
    "then",
    "res",
    "data",
    "ok",
    "r",
    "length",
    "i",
    "children",
    "list",
    "forEach",
    "child",
    "_bind",
    "load",
    "instantiate",
    "addChild",
    "btn",
    "getChildByName",
    "state",
    "awardStatus",
    "getComponent",
    "Label",
    "string",
    "awardStatusStr",
    "uri",
    "goodsImg",
    "name",
    "goodsName",
    "text",
    "receiveInfo",
    "createDate",
    "replace",
    "loader",
    "err",
    "texture",
    "console",
    "log",
    "img",
    "Sprite",
    "spriteFrame",
    "SpriteFrame",
    "goodsType",
    "sequence",
    "fadeOut",
    "callFunc"
  ],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "import PrizeDetail from 'prizeDetail'\r\n\r\nexport default cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        close: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        mask: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        layout: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        item: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        other: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        loginBtn: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        prizeDetail: {\r\n            default: null,\r\n            type: PrizeDetail\r\n        }\r\n    },\r\n\r\n\r\n    onLoad() {\r\n        this.prizeDetail.init()\r\n        this.listen()\r\n    },\r\n\r\n\r\n    listen() {\r\n        this.mask.on(\r\n            cc.Node.EventType.TOUCH_START,\r\n            event => {\r\n                event.stopPropagation()\r\n            }\r\n        )\r\n\r\n        /*\r\n        * 关闭按钮\r\n        */\r\n        this.close.on(\r\n            cc.Node.EventType.TOUCH_START,\r\n            () => {\r\n                this.close.scale = .95\r\n            }\r\n        )\r\n\r\n        this.close.on(\r\n            cc.Node.EventType.TOUCH_END,\r\n            () => {\r\n                this.close.scale = 1\r\n                this.hide()\r\n            }\r\n        )\r\n\r\n        //loginBtn\r\n        this.loginBtn.on(\r\n            cc.Node.EventType.TOUCH_START,\r\n            () => {\r\n                this.loginBtn.scale = .95\r\n            }\r\n        )\r\n\r\n        this.loginBtn.on(\r\n            cc.Node.EventType.TOUCH_END,\r\n            () => {\r\n                this.loginBtn.scale = 1\r\n                this.hide()\r\n                window._main.login.show()\r\n            }\r\n        )\r\n    },\r\n\r\n    show() {\r\n\r\n        const _this = this\r\n\r\n        window._main.api.monitor('抓去记录', 13)\r\n\r\n        if (this.node.active) this.node.opacity = 0\r\n        else {\r\n            this.node.active = true\r\n            this.node.opacity = 0\r\n        }\r\n        this.node.runAction(cc.fadeIn(.5))\r\n\r\n        if (!window._main.user.phone) {\r\n            this.other.active = true\r\n            this.layout.active = false\r\n        } else {\r\n            this.layout.active = true\r\n            this.other.active = false\r\n        }\r\n\r\n        window._main.api.grabHistory()\r\n        .then(res => {\r\n            if (res.data.ok) {\r\n                if (res.data.r.length === 0) {\r\n                    return\r\n                }\r\n                let i = 0\r\n                const\r\n                    children = this.layout.children,\r\n                    list = res.data.r\r\n\r\n                children.forEach(child => {\r\n                    child.active =\r\n                    child._bind = false\r\n                })\r\n                const load = () => {\r\n                    const\r\n                        item = list[i]\r\n                    let child = children[i]\r\n                    if (!child) {\r\n                        child = cc.instantiate(this.item)\r\n                        this.layout.addChild(child)\r\n                    }\r\n\r\n                    child.active = true\r\n                    child.opacity = 255\r\n                    \r\n                    // 获奖状态\r\n                    const \r\n                        btn = child.getChildByName('btn'),\r\n                        state = child.getChildByName('state')\r\n                    btn.active = \r\n                    state.active = false\r\n                    if (item.awardStatus === 0) {\r\n                        btn.active = true\r\n                    } else {\r\n                        state.active = true\r\n                        state.getComponent(cc.Label)\r\n                            .string = item.awardStatusStr\r\n                    }\r\n\r\n                    if (!child._bind) {\r\n                        child._bind = true\r\n\r\n                        btn.on(\r\n                            cc.Node.EventType.TOUCH_START,\r\n                            function() {\r\n                                this.scale = .95\r\n                            }\r\n                        )\r\n\r\n                        btn.on(\r\n                            cc.Node.EventType.TOUCH_END,\r\n                            function() {\r\n                                this.scale = 1\r\n                                _this.prizeDetail.show({\r\n                                    uri: item.goodsImg,\r\n                                    name: item.goodsName,\r\n                                    state: item.awardStatusStr,\r\n                                    text: item.receiveInfo\r\n                                })\r\n                            }\r\n                        )\r\n                    }\r\n                    \r\n\r\n                    child.getChildByName('layout').getChildByName('name')\r\n                        .getComponent(cc.Label).string = item.goodsName\r\n\r\n                    child.getChildByName('layout').getChildByName('date')\r\n                        .getComponent(cc.Label).string = item.createDate.replace(/(\\d{4})(\\d{2})(\\d{2})/, '$1-$2-$3')\r\n\r\n                    cc.loader.load(item.goodsImg, (err, texture) => {\r\n                        if (err) console.log(err)\r\n                        else {\r\n                            const img = child.getChildByName('image')\r\n                            img.getComponent(cc.Sprite)\r\n                                .spriteFrame = new cc.SpriteFrame(texture)\r\n                            if (item.goodsType === 1) img.scale = .3\r\n                            else img.scale = 1\r\n                        }\r\n                        if (++i < list.length) load()\r\n                    })\r\n\r\n                }\r\n                load()\r\n            }\r\n        })\r\n    },\r\n\r\n    hide() {\r\n        this.node.runAction(cc.sequence(\r\n            cc.fadeOut(.5),\r\n            cc.callFunc(() => {\r\n                this.node.active = false\r\n            })\r\n        ))\r\n    },\r\n\r\n\r\n\r\n})\r\n"
  ]
}